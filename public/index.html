
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Portal de Proveedores</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
    .resumen { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>

<h1>Listado de Entregas</h1>
<div class="resumen" id="resumen"></div>
<table id="tabla">
  <thead>
    <tr>
      <th>Fecha</th>
      <th>Remito</th>
      <th>CantBins</th>
      <th>ProveedorT</th>
      <th>Especie</th>
      <th>NomVariedad</th>
      <th>KgsD</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
function convertirFecha(excelNumber) {
  const baseDate = new Date(1899, 11, 30);
  baseDate.setDate(baseDate.getDate() + Math.floor(excelNumber));
  const dia = String(baseDate.getDate()).padStart(2, '0');
  const mes = String(baseDate.getMonth() + 1).padStart(2, '0');
  const anio = baseDate.getFullYear();
  return `${dia}/${mes}/${anio}`;
}

function fechaDentroDeRango(fechaExcel, desdeStr, hastaStr) {
  const baseDate = new Date(1899, 11, 30);
  const fecha = new Date(baseDate.getTime() + (Math.floor(fechaExcel) * 86400000));
  const desde = desdeStr ? new Date(desdeStr.split('/').reverse().join('-')) : null;
  const hasta = hastaStr ? new Date(hastaStr.split('/').reverse().join('-')) : null;
  if (desde && fecha < desde) return false;
  if (hasta && fecha > hasta) return false;
  return true;
}

// Cargar el JSON y renderizar la tabla
fetch("data/profru.json")
  .then(res => res.json())
  .then(data => {
    const tbody = document.querySelector("#tabla tbody");
    let totalKgs = 0;

    data.forEach(row => {
      const tr = document.createElement("tr");

      const fecha = convertirFecha(row.Fecha);
      tr.innerHTML = `
        <td>${fecha}</td>
        <td>${row.Remito}</td>
        <td>${row.CantBins}</td>
        <td>${row.ProveedorT}</td>
        <td>${row.Especie}</td>
        <td>${row.NomVariedad}</td>
        <td>${row.KgsD}</td>
      `;

      totalKgs += Number(row.KgsD) || 0;
      tbody.appendChild(tr);
    });

    document.getElementById("resumen").innerText = `Total KgsD: ${totalKgs.toLocaleString("es-AR")} kg`;
  });
</script>

</body>
</html>
